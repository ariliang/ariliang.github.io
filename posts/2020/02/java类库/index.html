<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Java类库 - Ari's home</title><link rel=icon type=image/png href=favicon.jpeg><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Java类库"><meta property="og:description" content="核心类与扩展类"><meta property="og:type" content="article"><meta property="og:url" content="https://ariliang.github.io/posts/2020/02/java%E7%B1%BB%E5%BA%93/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-20T23:47:27+08:00"><meta property="article:modified_time" content="2020-02-20T23:47:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Java类库"><meta name=twitter:description content="核心类与扩展类"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://ariliang.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://ariliang.github.io/css/main.css><link rel=stylesheet type=text/css href=https://ariliang.github.io/css/dark.css media="(prefers-color-scheme: dark)"><script src=https://ariliang.github.io/js/feather.min.js></script><script src=https://ariliang.github.io/js/main.js></script><script src=https://code.jquery.com/jquery-3.4.1.js></script></head><body><div class="container wrapper post"><div class=header><base href=https://ariliang.github.io/><h1 class=site-title><a href=https://ariliang.github.io/>Ari's home</a></h1><div class=site-description><nav class="nav social"><ul class=flat><a href=https://github.com/ariliang title=Github><i data-feather=github></i></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></div><div class=post-header><h1 class=title>Java类库</h1><div class=meta>Posted at &mdash; Feb 20, 2020</div></div><div class=post-toc><div class=toc-header>CATALOG</div><ul class=toc-h2><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#java%e6%a0%b8%e5%bf%83%e7%b1%bb class=toc-link>JAVA核心类</a></li><ul class=toc-h3><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%92%8c%e7%bc%96%e7%a0%81 class=toc-link>字符串和编码</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#stringbuilder class=toc-link>StringBuilder</a></li></ul><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#object class=toc-link>Object</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#%e5%ae%b9%e5%99%a8%e7%b1%bb class=toc-link>容器类</a></li><ul class=toc-h3><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#arrays class=toc-link>Arrays</a></li></ul><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#io class=toc-link>IO</a></li><ul class=toc-h3><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#filepath%e5%af%b9%e8%b1%a1 class=toc-link>File/Path对象</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#inputstreamoutputstream class=toc-link>InputStream/OutputStream</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#filter%e6%a8%a1%e5%bc%8f class=toc-link>Filter模式</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#%e8%af%bb%e5%8f%96classpath class=toc-link>读取classpath</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#%e5%ba%8f%e5%88%97%e5%8c%96 class=toc-link>序列化</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#readerwriter class=toc-link>Reader/Writer</a></li><li><a href=/posts/2020/02/java%E7%B1%BB%E5%BA%93/#printstreamprintwriter class=toc-link>PrintStream/PrintWriter</a></li></div><div class=markdown><h1 id=java类库>Java类库</h1><h2 id=java核心类>JAVA核心类</h2><h3 id=字符串和编码>字符串和编码</h3><ol><li>实际上字符串内部是用<code>char[]</code>来表示的</li></ol><blockquote><p>比如<code>String s = new String(new char[] {'H', 'e', 'l', 'l', 'o', '!'});</code>
它的内部的字段定义是<code>private final char[]</code>，所以字符串对象是恒定不变的</p></blockquote><ol><li>字符串比较应该利用<code>equals()</code>而不是<code>==</code>，因为字符串是引用类型，<code>==</code>比较的是引用值</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#6272a4>// 比较内容，利用==比较也为true，是因为编译器会自动把相同的字符串当作一个对象放入常量池，自然引用&#34;hello&#34;和引用s的引用值是相等的
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#6272a4></span>String s <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;hello&#34;</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#8be9fd>boolean</span> isEqual1 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>equals</span><span style=color:#ff79c6>(</span>s<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>?</span> <span style=color:#ff79c6>true</span> <span style=color:#ff79c6>:</span> <span style=color:#ff79c6>false</span><span style=color:#ff79c6>;</span>	<span style=color:#6272a4>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#6272a4></span><span style=color:#8be9fd>boolean</span> isEqual2 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;hello&#34;</span> <span style=color:#ff79c6>==</span> s <span style=color:#ff79c6>?</span> <span style=color:#ff79c6>true</span> <span style=color:#ff79c6>:</span> <span style=color:#ff79c6>false</span><span style=color:#ff79c6>;</span>			<span style=color:#6272a4>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#6272a4>// 比较内容，s与&#34;hello&#34;.toUpperCase()的引用不相同
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span style=color:#6272a4></span>String s <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;HELLO&#34;</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span style=color:#8be9fd>boolean</span> isEqual <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>toUpperCase</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;s&#34;</span> <span style=color:#ff79c6>?</span> <span style=color:#ff79c6>true</span> <span style=color:#ff79c6>:</span> <span style=color:#ff79c6>false</span><span style=color:#ff79c6>;</span>	<span style=color:#6272a4>// false
</span></code></pre></div><ol><li>常用方法</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>equalsIgnoreCase</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// true，忽略大小写比较
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>contains</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;llo&#34;</span><span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// true，是否包含某个子串，方法参数是CharSequence
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>indexOf</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;e&#34;</span><span style=color:#ff79c6>);</span>				<span style=color:#6272a4>// 1，子串的索引，由0开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>lastIndexOf</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;l&#34;</span><span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// 3，最后一个字串的索引，0开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>startsWith</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;He&#34;</span><span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// true，由某个字串开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>endsWith</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;lo&#34;</span><span style=color:#ff79c6>);</span>				<span style=color:#6272a4>// true，由某个字串结束
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#f1fa8c>&#34; \nHello\r\t&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>trim</span><span style=color:#ff79c6>();</span>				<span style=color:#6272a4>// &#34;Hello&#34;，去除首尾空白字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;\u3000Hello\u3000&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>strip</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// &#34;Hello&#34;，去除首尾空白字符，包括其他语言的，&#39;\u3000&#39;是中文的空格
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34; Hello &#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>stripLeading</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// &#34;Hello &#34;，去除头部空白字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34; Hello &#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>stripEnding</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// &#34; Hello&#34;，去除尾部空白字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#f1fa8c>&#34;&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>isEmpty</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;  \n&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>isBlank</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>subString</span><span style=color:#ff79c6>(</span>2<span style=color:#ff79c6>);</span>				<span style=color:#6272a4>// &#34;llo&#34;，提取2到末尾的字串，索引从0开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>subString</span><span style=color:#ff79c6>(</span>2<span style=color:#ff79c6>,</span> 4<span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// &#34;ll&#34;，2到3字串，4之前
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>replace</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#39;l&#39;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;w&#39;</span><span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// &#34;hewwo&#34;，替换字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>replace</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;ll&#34;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#34;~~&#34;</span><span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// &#34;he~~o&#34;，所有&#34;ll&#34;替换为&#34;~~&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#6272a4>// 还有正则表达式的替换，待添加
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>String<span style=color:#ff79c6>[]</span> arr <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;A,B,C,D&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>split</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;\\,&#34;</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// [&#34;A&#34;, &#34;B&#34;, &#34;C&#34;, &#34;D&#34;]，正则表达式来分割
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#6272a4></span>String s <span style=color:#ff79c6>=</span> String<span style=color:#ff79c6>.</span><span style=color:#50fa7b>join</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;***&#34;</span><span style=color:#ff79c6>,</span> arr<span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// &#34;A***B***C***D&#34;，拼接字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>String<span style=color:#ff79c6>.</span><span style=color:#50fa7b>valueOf</span><span style=color:#ff79c6>(</span>123<span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// 将其他类型转换为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span style=color:#6272a4></span>String<span style=color:#ff79c6>.</span><span style=color:#50fa7b>valueOf</span><span style=color:#ff79c6>(</span>35<span style=color:#ff79c6>.</span><span style=color:#50fa7b>43</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>String<span style=color:#ff79c6>.</span><span style=color:#50fa7b>valueOf</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>true</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// &#34;true&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#6272a4></span>String<span style=color:#ff79c6>.</span><span style=color:#50fa7b>valueOf</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> Object<span style=color:#ff79c6>());</span>	<span style=color:#6272a4>//	类似java.lang.Object@636be97c
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span style=color:#6272a4>// String可以和char[]相互转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span style=color:#6272a4></span><span style=color:#8be9fd>char</span><span style=color:#ff79c6>[]</span> cs <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>toCharArray</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// String --&gt; char[]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span style=color:#6272a4></span>String s <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> String<span style=color:#ff79c6>(</span>cs<span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// char[] --&gt; String
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span style=color:#6272a4></span><span style=color:#8be9fd>char</span><span style=color:#ff79c6>[</span>0<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;X&#39;</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>s<span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// &#34;Hello&#34;，修改了char[]后s并不会改变，因为两者是不同的对象。new String(char[]);是复制，若传入的对象有可能改变，那么是复制内容
</span></code></pre></div><ol><li>字符编码</li></ol><blockquote><ol><li>ASCII只有1个字节编码的范围是0~127(0000 0000~0111 1111)，高位始终为0</li><li>GB2312采用2字节，第一个高位始终为1以便和ASCII码区分(1000 0000 0000 0000 ~ 1111 1111 1111)</li><li>Unicode编码使用两个或更多字节，英文字符就是简单的在前面加00，因为这样会浪费空间，就出现了UTF-8，把固定长度的Unicode编码编程1~4字节的变长编码</li><li>UTF-8依靠高字节来确定一个字符究竟是几个字节，传输中容错能强，常用作传输编码</li><li>Java的String和char在内存中总是以Unicode表示</li></ol></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// char类型实际上是两个字节的Unicode编码，可以手动把字符串转换为其他编码，转换后不再是char类型，而是byte型数组
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4>// 转换为byte[]类型的时候优先考虑UTF-8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#6272a4></span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b1 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// 按ISO8859-1编码转换，不推荐
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#6272a4></span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b2 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;UTF-8&#34;</span><span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// 按UTF-8转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b3 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;GBK&#34;</span><span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// 按GBK转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4></span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b4 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>(</span>StandardCharsets<span style=color:#ff79c6>.</span><span style=color:#50fa7b>UTF_8</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// 按UTF-8转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4>// 将已知的byte型数组转化为String
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4></span>String s1 <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> String<span style=color:#ff79c6>(</span>b3<span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#34;GBK&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>String s2 <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> String<span style=color:#ff79c6>(</span>b4<span style=color:#ff79c6>,</span> StandardCharsets<span style=color:#ff79c6>.</span><span style=color:#50fa7b>UTF_8</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#6272a4>// 早期的String内部由char[]实现，而现在内部是byte[]，因为许多情况下只有ASCII内容，而使用char[]会浪费内存，利用byte[]能够存储一个字节，更节约
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd;font-style:italic>final</span> <span style=color:#8be9fd>char</span><span style=color:#ff79c6>[]</span> value<span style=color:#ff79c6>;</span>  <span style=color:#ff79c6>--&gt;</span>  <span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd;font-style:italic>final</span> <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> value<span style=color:#ff79c6>;</span>
</code></pre></div><h3 id=stringbuilder>StringBuilder</h3><ol><li>java对String做了特殊处理，可以直接使用<code>+</code>拼接字符串</li><li>构造复杂的字符串利用<code>StringBuilder</code></li></ol><h2 id=object>Object</h2><p>方法列表</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#6272a4>// toString();	将内容输出为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#6272a4>// equals();	判断是否逻辑相等
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#6272a4>// hashCode();	计算instance的hash值
</span></code></pre></div><h2 id=容器类>容器类</h2><h3 id=arrays>Arrays</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#6272a4>// 将数值类型转化为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#6272a4></span>Arrays<span style=color:#ff79c6>.</span><span style=color:#50fa7b>toString</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>Arrays<span style=color:#ff79c6>.</span><span style=color:#50fa7b>deepToString</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// 输出多维数组为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#6272a4>// 排序，若是对基本类型数组排序，则改变了数组元素的的位置。
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#6272a4>// 若是对引用类型排序，如字符串，则改变了索引的引用值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span style=color:#6272a4></span>Arrays<span style=color:#ff79c6>.</span><span style=color:#50fa7b>sort</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>
</code></pre></div><h2 id=io>IO</h2><ol><li><p>IO是指内存和外部硬盘，网络等的数据交换，以内存为中心；实际上在内存中以某种数据结构表示，如<code>byte[]</code>，<code>String</code></p></li><li><p>IO分为同步和异步，分别在包<code>java.io</code>和<code>java.nio</code>中；同步指必须在IO结束后才能继续后续步骤，异步指只是发出IO请求，立刻执行后续步骤</p></li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 同步IO
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#ff79c6>import</span> java.io<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#6272a4>/* 
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4>* 抽象类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4>* 	InputStream/OutputStream, Reader/Writer
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#6272a4>* 实现类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4>* 	FileInputStream/FileOutputStream, FileReader/FileWriter
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4>*/</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#6272a4>// 异步IO
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#6272a4></span><span style=color:#ff79c6>import</span> java.nio
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#6272a4>/*
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#6272a4>*	Path/Paths
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#6272a4>*
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#6272a4>*/</span>
</code></pre></div><h3 id=filepath对象>File/Path对象</h3><p>利用<code>File</code>来操作文件和目录，<code>File</code>既可以表示文件，也可以表示目录；构造<code>File</code>时只是构造对象，不会进行任何IO操作，所以不会报错。而在调用的时候，才会有磁盘操作</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 要构造一个File对象需要传入文件/目录路径，可以是绝对路径，也可以是相对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span>File f1 <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> File<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;D:\\Downloads&#34;</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// Win下，绝对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#6272a4></span>File f2 <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> File<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;/home/user&#34;</span><span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// unix下
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#6272a4></span>System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>File<span style=color:#ff79c6>.</span><span style=color:#50fa7b>separator</span><span style=color:#ff79c6>)</span>		<span style=color:#6272a4>// 返回当前OS分隔符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span>File f3 <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> File<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./dir&#34;</span><span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// 相对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4></span>File f4 <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Fifle<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;../test&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4>// 利用File对象获取三种路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getPath</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// (String)返回构造方法传入的路径：./Downloads
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getAbsoluttePath</span><span style=color:#ff79c6>/</span>File<span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// (String/File)返回绝对路径：类似 D:\Downloads\..\Downloa
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#6272a4></span>ds
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getCanonicalPath</span><span style=color:#ff79c6>/</span>File<span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// (String/File)返回绝对规范路径：类似 D:\Downloads
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getName</span><span style=color:#ff79c6>();</span>				<span style=color:#6272a4>// String，返回文件或目录的名字
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#6272a4>// 文件或目录操作，在调用这些方法的时候才会进行实际的磁盘访问
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>exists</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>isFile</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// 是否是文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>diDirectory</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// 是否是目录
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>canRead</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// boolean
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>canWrite</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// boolean
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>canExecute</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// boolean，目录的话代表是否可以列出其子目录和文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>lastModified</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// long，返回上次修改时间
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>setReadable</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>true</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// 设置可读，同样还有可写，可执行，修改上次修改时间
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>length</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// long，文件字节大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getFreeSpace</span><span style=color:#ff79c6>/</span>TotalSpace<span style=color:#ff79c6>/</span>UsableSpace<span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// long, 返回空间大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>createNewFile</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// 创建新文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span style=color:#6272a4></span>File f <span style=color:#ff79c6>=</span> File<span style=color:#ff79c6>.</span><span style=color:#50fa7b>createTempFile</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;tmp-&#34;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#34;.txt&#34;</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// 创建临时文件，指定前缀和后缀，类似 temp-342556345.txt
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>delete</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// 删除文件或目录，删除目录时必须为空
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>deleteOnExit</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// JVM退出时自动删除
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span style=color:#6272a4></span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>mkdir</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>mkdirs</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// 级联创建目录
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span style=color:#6272a4>// 遍历文件和目录
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span style=color:#6272a4></span>String<span style=color:#ff79c6>[]</span> fl <span style=color:#ff79c6>=</span> f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>list</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// String[]，同上，以String数组返回
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span style=color:#6272a4></span>File<span style=color:#ff79c6>[]</span> fl <span style=color:#ff79c6>=</span> f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>listFiles</span><span style=color:#ff79c6>();</span>	<span style=color:#6272a4>// File[]，列出所有文件和目录，以File数组形式返回
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span style=color:#6272a4></span>File<span style=color:#ff79c6>[]</span> fl <span style=color:#ff79c6>=</span> f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>listFiles</span><span style=color:#ff79c6>(</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span>    <span style=color:#ff79c6>new</span> FilenameFilter<span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span>        <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>boolean</span> <span style=color:#50fa7b>accept</span><span style=color:#ff79c6>(</span>File dir<span style=color:#ff79c6>,</span> String name<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span>            <span style=color:#ff79c6>return</span> name<span style=color:#ff79c6>.</span><span style=color:#50fa7b>endWith</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;.exe&#34;</span><span style=color:#ff79c6>);</span>  <span style=color:#6272a4>// 仅列出该类型文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span style=color:#6272a4></span>        <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// 传入一个过滤对象，过滤不必要的文件或目录
</span></code></pre></div><p>可以利用Path类来更轻松地创建路径<code>java.nio.file.Path/Paths</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 构造一个路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span>Path p <span style=color:#ff79c6>=</span> Paths<span style=color:#ff79c6>.</span><span style=color:#50fa7b>get</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;.&#34;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#34;Downloads&#34;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#34;temp&#34;</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// Path，返回一个Path对象，其路径为 ./Downloads/temp
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#6272a4></span>p <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span><span style=color:#50fa7b>toAbsolutePath</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// Path，返回绝对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#6272a4></span>p <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span><span style=color:#50fa7b>normalize</span><span style=color:#ff79c6>();</span>			<span style=color:#6272a4>// Path，返回标准路径（不是绝对的）；要先 toAbsolutePath()，再 normalize()，才能得到标准的绝对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4>// 与File对象相互转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#6272a4></span>File f <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span><span style=color:#50fa7b>toFile</span><span style=color:#ff79c6>();</span>		<span style=color:#6272a4>// File，返回File对象
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4></span>p <span style=color:#ff79c6>=</span> f<span style=color:#ff79c6>.</span><span style=color:#50fa7b>toPath</span><span style=color:#ff79c6>();</span>				<span style=color:#6272a4>// Path，返回Path对象
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#6272a4>// 遍历
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#6272a4></span><span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span>Path p <span style=color:#ff79c6>:</span> Paths<span style=color:#ff79c6>.</span><span style=color:#50fa7b>get</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;..&#34;</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>toAbsolutePath</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>print</span><span style=color:#ff79c6>(</span>p <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#34;, &#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#ff79c6>}</span>	<span style=color:#6272a4>// 构造成 */*/.. 路径，再把其变为绝对路径拆开输出：*, *, ..
</span></code></pre></div><h3 id=inputstreamoutputstream>InputStream/OutputStream</h3><p><code>InputSteam/OutputStream</code>：IO流以<em>字节*为单位(byte)，因此也称为字节流；<code>InputStream</code>表示输入流，<code>OutputStream</code>表示输出流，是两种基本的流；*它们的特点是像水流一样单向流动</em>
它们并不是接口，而是抽象类，是一切输入输出流的超类</p><p><strong>InputStream</strong></p><p>定义了一个重要的抽象方法 <code>pubilc abstract int read() throws IOException;</code>这个抽象方法会读出下一个字节，以int返回(0~255)，读到末尾-1表示</p><p>在调用read()时是阻塞(Blocking)的，即IO未完成之前不会执行后续步骤</p><blockquote><p>实现类：</p><p><code>FileInputStream</code>文件输入流</p><p><code>ByteArrayInputStream</code>在内存中模拟一个输入流，实际上是把<code>byte[]</code>当作<code>InputStream</code>，可以用于测试</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 实现类 FileInputStream 文件输入流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4>// 打开资源并使用后一定要记得关闭，下面展示了一个最简单的方法，但不是最常用的
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>readFile</span><span style=color:#ff79c6>()</span> <span style=color:#8be9fd;font-style:italic>throws</span> IOException <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>   InputStream input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileInputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./text.txt&#34;</span><span style=color:#ff79c6>);</span>   <span style=color:#6272a4>// 传入文件路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span>   <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(;;)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>      <span style=color:#8be9fd>int</span> n <span style=color:#ff79c6>=</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>();</span>   <span style=color:#6272a4>// 读出下一个byte值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#6272a4></span>      <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>n <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>         <span style=color:#ff79c6>break</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>      <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>      System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>n<span style=color:#ff79c6>);</span>  <span style=color:#6272a4>// 打印byte的值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#6272a4></span>   <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>   input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>close</span><span style=color:#ff79c6>();</span>    <span style=color:#6272a4>// 关闭流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#6272a4>// 文件输入输出流不管是否成功或失败，都需要及时关闭资源
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>readFile</span><span style=color:#ff79c6>()</span> <span style=color:#8be9fd;font-style:italic>throws</span> IOException <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>   InputStream input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>null</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>   <span style=color:#ff79c6>try</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>      input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileInputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./text.txt&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>      <span style=color:#ff79c6>for</span><span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> n<span style=color:#ff79c6>;</span> <span style=color:#ff79c6>(</span>n <span style=color:#ff79c6>=</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>;)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>         System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>n<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>      <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>   <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>finally</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>      <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>input <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>null</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>close</span><span style=color:#ff79c6>();</span> <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>   <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#6272a4>// 利用try(resources)来自动关闭资源，常用(JAVA 7引入)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>readFile</span><span style=color:#ff79c6>()</span> IOException <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>   <span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>InputStream input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileInputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./text.txt&#34;</span><span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>      <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> n<span style=color:#ff79c6>;(</span>n <span style=color:#ff79c6>=</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>         System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>n<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>      <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>   <span style=color:#ff79c6>}</span>  <span style=color:#6272a4>// 自动关闭，决定于try()里边的对象是否实现了java.lang.AutoClosable接口，里边有finally，并调用close()
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span style=color:#6272a4>// 一次读取一个字节不是高效的办法，利用缓冲可以一次读取多个字节；每次会读满buffer.length个字节，然后清空之前读的字节，记录读到的位置，直到整个文件读完
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span style=color:#6272a4></span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> buffer <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[</span>1000<span style=color:#ff79c6>];</span>        <span style=color:#6272a4>// 定义一个buffer，每次读取字节数不会超过这个数组的大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span style=color:#6272a4></span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>read</span><span style=color:#ff79c6>(</span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b<span style=color:#ff79c6>);</span>                    <span style=color:#6272a4>// 读取若干字节填充到byte[]，返回读取的字节数，返回-1表示没有更多的字节了
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span style=color:#6272a4></span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>read</span><span style=color:#ff79c6>(</span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b<span style=color:#ff79c6>,</span> <span style=color:#8be9fd>int</span> off<span style=color:#ff79c6>,</span> <span style=color:#8be9fd>int</span> len<span style=color:#ff79c6>);</span>  <span style=color:#6272a4>// 同时指定偏移量和最大填充数
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>readFile</span><span style=color:#ff79c6>(){</span>		<span style=color:#6272a4>// 缓冲读取完整步骤
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span style=color:#6272a4></span>    <span style=color:#6272a4>// 利用缓冲读取字节流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span style=color:#6272a4></span>    <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> btBuffer <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[</span>1000<span style=color:#ff79c6>];</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span>    <span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>InputStream fs <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileInputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./text.txt&#34;</span><span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span>        <span style=color:#6272a4>// read()返回的是读取的长度
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span style=color:#6272a4></span>        <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> n<span style=color:#ff79c6>;</span> <span style=color:#ff79c6>(</span>n <span style=color:#ff79c6>=</span> fs<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>(</span>btBuffer<span style=color:#ff79c6>))</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>;){</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span>            <span style=color:#6272a4>// byte数组输出为字符串的时候必须指定(offset, len, charset)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span style=color:#6272a4></span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> String<span style=color:#ff79c6>(</span>btBuffer<span style=color:#ff79c6>,</span> 0<span style=color:#ff79c6>,</span> n<span style=color:#ff79c6>,</span> StandardCharsets<span style=color:#ff79c6>.</span><span style=color:#50fa7b>UTF_8</span><span style=color:#ff79c6>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span>        <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span>    <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>catch</span> <span style=color:#ff79c6>(</span>Exception e<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span>    System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span style=color:#6272a4>// ByteArrayInputStream，模拟输入流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span style=color:#6272a4></span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> data <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span> 72<span style=color:#ff79c6>,</span> 101<span style=color:#ff79c6>,</span> 108<span style=color:#ff79c6>,</span> 108<span style=color:#ff79c6>,</span> 111<span style=color:#ff79c6>,</span> 33 <span style=color:#ff79c6>};</span>		<span style=color:#6272a4>// 构造byte[]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span style=color:#6272a4>// 从byte[]中输入
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>InputStream input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> ByteArrayInputStream<span style=color:#ff79c6>(</span>data<span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span>    <span style=color:#8be9fd>int</span> n<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span>    <span style=color:#ff79c6>while</span> <span style=color:#ff79c6>((</span>n <span style=color:#ff79c6>=</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>((</span><span style=color:#8be9fd>char</span><span style=color:#ff79c6>)</span>n<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span style=color:#ff79c6>}</span>
</code></pre></div><p><strong>OutputStream</strong></p><p>这个抽象类定义了一个重要的方法<code>public abstract void write(int b) throws IOException</code>每次写入一个字节byte</p><p>因为它先把写入的字节放到缓冲区而不是真正的写入，当缓冲区写满时才会把缓冲区写入，它还提供了另外一个方法<code>flush()</code>，利用它可以立即把缓冲区写入到文件，网络等</p><p>在调用<code>close()</code>的时候会自动调用<code>flush()</code></p><p>OutputStream也是阻塞的</p><blockquote><p>实现类：</p><p><code>FileOutputStream</code>文件输出流</p><p><code>ByteArrayOutputStream</code>内存模拟输出流</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// write()每次写入一个字节，或一个byte[],写入后会覆盖原文件内容
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> <span style=color:#ff79c6>{</span><span style=color:#f1fa8c>&#39;e&#39;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;l&#39;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;l&#39;</span><span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#39;o&#39;</span><span style=color:#ff79c6>};</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>String s <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;world!&#34;</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>OutputStream output <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileOutputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./text.txt&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>write</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#39;h&#39;</span><span style=color:#ff79c6>);</span>				<span style=color:#6272a4>// char/int
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4></span>output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>write</span><span style=color:#ff79c6>(</span>43<span style=color:#ff79c6>);</span>				<span style=color:#6272a4>// 0~255
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#6272a4></span>output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>write</span><span style=color:#ff79c6>(</span>b<span style=color:#ff79c6>,</span> 0<span style=color:#ff79c6>,</span> b<span style=color:#ff79c6>.</span><span style=color:#50fa7b>length</span><span style=color:#ff79c6>);</span>	<span style=color:#6272a4>// (byte[], offset, len)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4></span>output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>write</span><span style=color:#ff79c6>(</span>s<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>(</span>StandardCharsets<span style=color:#ff79c6>.</span><span style=color:#50fa7b>UTF_8</span><span style=color:#ff79c6>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>close</span><span style=color:#ff79c6>();</span>					<span style=color:#6272a4>// 关闭输出流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#6272a4></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#6272a4>// 同样的，应该把文件的输出流放在try(resources)中，会自动关闭文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>OutputStream output <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileOutputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./text.txt&#34;</span><span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>write</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#39;h&#39;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#ff79c6>}</span> <span style=color:#ff79c6>catch</span> <span style=color:#ff79c6>(</span>Exception e<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{}</span>
</code></pre></div><h3 id=filter模式>Filter模式</h3><p>通过基础组件再叠加各种附加功能组件的模式，叫做Filter模式，或者装饰器(Decorator)模式；如图，各种<code>*InputStream</code>都可以用<code>InputStream</code>来使用，而且仅仅是在基础的数据录入源的基础上增添功能，若每个附加的功能都写一个类，那样会使类的数量大大增</p><p><img src=images/Java%E7%B1%BB%E5%BA%93/Filter-mod.png alt=Filer-mod></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 编写 FilterInputStream 扩展类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>Main</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>main</span><span style=color:#ff79c6>(</span>String<span style=color:#ff79c6>[]</span> args<span style=color:#ff79c6>)</span> <span style=color:#8be9fd;font-style:italic>throws</span> IOException <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>        <span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> data <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;hello, world!&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytes</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;UTF-8&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>        <span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>CountInputStream input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> CountInputStream<span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> ByteArrayInputStream<span style=color:#ff79c6>(</span>data<span style=color:#ff79c6>)))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>            <span style=color:#8be9fd>int</span> n<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>            <span style=color:#ff79c6>while</span> <span style=color:#ff79c6>((</span>n <span style=color:#ff79c6>=</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>                System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>((</span><span style=color:#8be9fd>char</span><span style=color:#ff79c6>)</span>n<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>            <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;Total read &#34;</span> <span style=color:#ff79c6>+</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getBytesRead</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#34; bytes&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>        <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>CountInputStream</span> <span style=color:#8be9fd;font-style:italic>extends</span> FilterInputStream <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    <span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd>int</span> count <span style=color:#ff79c6>=</span> 0<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>    CountInputStream<span style=color:#ff79c6>(</span>InputStream in<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>        <span style=color:#8be9fd;font-style:italic>super</span><span style=color:#ff79c6>(</span>in<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>int</span> <span style=color:#50fa7b>getBytesRead</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>count</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>int</span> <span style=color:#50fa7b>read</span><span style=color:#ff79c6>()</span> <span style=color:#8be9fd;font-style:italic>throws</span> IOException <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>        <span style=color:#8be9fd>int</span> n <span style=color:#ff79c6>=</span> in<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>        <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>n <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>            <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>count</span> <span style=color:#ff79c6>++;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>        <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>        <span style=color:#ff79c6>return</span> n<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>int</span> <span style=color:#50fa7b>read</span><span style=color:#ff79c6>(</span><span style=color:#8be9fd>byte</span><span style=color:#ff79c6>[]</span> b<span style=color:#ff79c6>,</span> <span style=color:#8be9fd>int</span> off<span style=color:#ff79c6>,</span> <span style=color:#8be9fd>int</span> len<span style=color:#ff79c6>)</span> <span style=color:#8be9fd;font-style:italic>throws</span> IOException <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>        <span style=color:#8be9fd>int</span> n <span style=color:#ff79c6>=</span> in<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>(</span>b<span style=color:#ff79c6>,</span> off<span style=color:#ff79c6>,</span> len<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span>        <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>count</span> <span style=color:#ff79c6>+=</span> n<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>        <span style=color:#ff79c6>return</span> n<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span style=color:#ff79c6>}</span>
</code></pre></div><p>操作Zip，它是一种 <code>FilterInputStream</code>；另外<code>JarInputStream</code>派生自 <code>ZipInputStream</code>，是在zip的基础上增加对<code>MANIFEST.MF</code>文件的读写</p><p><img src=images/Java%E7%B1%BB%E5%BA%93/filter-zip.png alt=filter-zip></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 读取压缩包内容
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>ZipInputStream zip <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> ZipInputStream<span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> FileInputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./zip.zip&#34;</span><span style=color:#ff79c6>)))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span>ZipEntry entry<span style=color:#ff79c6>;</span> <span style=color:#ff79c6>(</span>entry <span style=color:#ff79c6>=</span> zip<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getNextEntry</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>null</span><span style=color:#ff79c6>;</span> <span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>print</span><span style=color:#ff79c6>(</span>entry<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getName</span><span style=color:#ff79c6>());</span>		<span style=color:#6272a4>// 获取压缩包内部文件或目录的名字
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>print</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;, &#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>print</span><span style=color:#ff79c6>(</span>entry<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getTime</span><span style=color:#ff79c6>());</span>		<span style=color:#6272a4>// 获取内容的时间
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#6272a4></span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>print</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;, &#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>entry<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getSize</span><span style=color:#ff79c6>());</span>	<span style=color:#6272a4>// 获取压缩前内容的大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4></span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#ff79c6>}</span> <span style=color:#ff79c6>catch</span> <span style=color:#ff79c6>(</span>Exception e<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>    <span style=color:#6272a4>//TODO: handle exception
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#6272a4>// 写入压缩包
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>ZipOutputStream zip <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> ZipOutputStream<span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> FileOutputStream<span style=color:#ff79c6>(...)))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    File<span style=color:#ff79c6>[]</span> files <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>...</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span>File file <span style=color:#ff79c6>:</span> files<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>        zip<span style=color:#ff79c6>.</span><span style=color:#50fa7b>putNextEntry</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> ZipEntry<span style=color:#ff79c6>(</span>file<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getName</span><span style=color:#ff79c6>()));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>        zip<span style=color:#ff79c6>.</span><span style=color:#50fa7b>write</span><span style=color:#ff79c6>(</span>getFileDataAsBytes<span style=color:#ff79c6>(</span>file<span style=color:#ff79c6>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>        zip<span style=color:#ff79c6>.</span><span style=color:#50fa7b>closeEntry</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#ff79c6>}</span>
</code></pre></div><h3 id=读取classpath>读取<code>classpath</code></h3><p>经常读取配置文件，且每次写磁盘路径很麻烦，可以利用<code>classpath</code>而不用关心具体的路径，这样就解决了文件路径依赖。它的路径从<code>/</code>开始，可以包含任意其他类型格式</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 先获取到当前Class对象，getResourceAsStream()当对象不存在时返回null
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>InputStream input <span style=color:#ff79c6>=</span> getClass<span style=color:#ff79c6>().</span><span style=color:#50fa7b>getResourceAsStream</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;/default.properties&#34;</span><span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>input <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>null</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>        <span style=color:#6272a4>// TODO
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4>// 默认的配置在jar包中，若有用户配置，则读取用户配置
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4></span>Properties props <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Properties<span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>props<span style=color:#ff79c6>.</span><span style=color:#50fa7b>load</span><span style=color:#ff79c6>(</span>inputStreamFromClassPath<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;/default.properties&#34;</span><span style=color:#ff79c6>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>props<span style=color:#ff79c6>.</span><span style=color:#50fa7b>load</span><span style=color:#ff79c6>(</span>inputStreamFromFile<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./conf.properties&#34;</span><span style=color:#ff79c6>));</span>
</code></pre></div><h3 id=序列化>序列化</h3><p>序列化就是把java对象编程二进制内容，本质就是一个<code>byte[]</code>，因为序列化后可以把对象保存到文件中，便于传输</p><p>反序列化时由<code>byte[]</code>直接生成对象，不会调用构造方法，但是这个过程中会产生安全问题；而且Java的序列化机制仅适用于Java，要和其他语言交换数据，要使用通用的序列化方法：如 Json，只输出基本类型和String</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 要实现对象的序列化，必须实现一个特殊接口 java.io.Serializable；它没有定义任何方法，是一个空接口，称这种接口叫做标记接口
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>interface</span> <span style=color:#50fa7b>Serializable</span> <span style=color:#ff79c6>{}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#6272a4>// 序列化需要使用 ObjectOutputStream，它可以写入基本类型如int/boolean，也可以写入String等；还可以写入实现了 Sreierializeable 接口的 Object，写入 Object 需要大量信息，所以内容很大
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#6272a4></span>ByteArrayOutputStream buffer <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> ByteArrayOutputStream<span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>ObjectOutputStream output <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> ObjectOutputStream<span style=color:#ff79c6>(</span>buffer<span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>    output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>writeInt</span><span style=color:#ff79c6>(</span>12345<span style=color:#ff79c6>);</span>			<span style=color:#6272a4>// 写入int:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4></span>    output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>writeUTF</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>);</span>		<span style=color:#6272a4>// 写入String:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#6272a4></span>    output<span style=color:#ff79c6>.</span><span style=color:#50fa7b>writeObject</span><span style=color:#ff79c6>(</span>Double<span style=color:#ff79c6>.</span><span style=color:#50fa7b>valueOf</span><span style=color:#ff79c6>(</span>123<span style=color:#ff79c6>.</span><span style=color:#50fa7b>456</span><span style=color:#ff79c6>));</span>	<span style=color:#6272a4>// 写入Object:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>Arrays<span style=color:#ff79c6>.</span><span style=color:#50fa7b>toString</span><span style=color:#ff79c6>(</span>buffer<span style=color:#ff79c6>.</span><span style=color:#50fa7b>toByteArray</span><span style=color:#ff79c6>()));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#6272a4>// 反序列化，调用 readObject() 可以直接返回一个对象，必须强制转型；反序列化时是直接构造出 Object，不会调用其构造方法，导致了安全性问题
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>ObjectInputStream input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> ObjectInputStream<span style=color:#ff79c6>(...))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>    <span style=color:#8be9fd>int</span> n <span style=color:#ff79c6>=</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>readInt</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    String s <span style=color:#ff79c6>=</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>readUTF</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    Double d <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>(</span>Double<span style=color:#ff79c6>)</span> input<span style=color:#ff79c6>.</span><span style=color:#50fa7b>readObject</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#6272a4>// 序列化和反序列化过程中很可能发生一些错误
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#6272a4></span>ClassNotFoundException<span style=color:#ff79c6>;</span>		<span style=color:#6272a4>// 反序列化时没有对应的类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#6272a4></span>InvalidClassException<span style=color:#ff79c6>;</span>		<span style=color:#6272a4>// Class不匹配，比如 int 和 long 不匹配
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#6272a4>// 所以序列化时允许 Class 定义一个特殊的 ID；静态变量 serialVersionUID(非必须)，用于标识序列化的版本，通常由IDE生成；如果增加或修改了字段，就可以改变其值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>Person</span> <span style=color:#8be9fd;font-style:italic>implements</span> Serializable <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>    <span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd;font-style:italic>final</span> <span style=color:#8be9fd>long</span> serialVersionUID <span style=color:#ff79c6>=</span> 2709425275741743919L<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#ff79c6>}</span>
</code></pre></div><h3 id=readerwriter>Reader/Writer</h3><p>若要读写的是字符(char)，且字符不全是单字节表示的ASCII，那么按照<code>char</code>来读写更方便，这种流称为字符流；其本质是一个能自动编解码的<code>InputStream/OutputStream</code>，会自动地在byte和char之间转换，<em>需指定编码方式</em></p><p><strong>Reader</strong></p><p>操作大概与<code>InputStream</code>类似</p><p><img src=images/Java%E7%B1%BB%E5%BA%93/comparasion-between-inputstream-and-reader.png alt=comparasion-between-inputstream-and-reader></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#6272a4>// 同样的，可以利用缓冲，一次读取多个字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>readFile</span><span style=color:#ff79c6>(){</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#6272a4>// 利用缓冲读取字符流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#6272a4></span>    <span style=color:#8be9fd>char</span><span style=color:#ff79c6>[]</span> chBuffer <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd>char</span><span style=color:#ff79c6>[</span>1000<span style=color:#ff79c6>];</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>    <span style=color:#6272a4>// 构造时传入文件路径和编码方式
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4></span>    <span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>Reader rd <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileReader<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;./text.txt&#34;</span><span style=color:#ff79c6>,</span> StandardCharsets<span style=color:#ff79c6>.</span><span style=color:#50fa7b>UTF_8</span><span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>        <span style=color:#6272a4>// read()返回的是读取字符个数
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#6272a4></span>        <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> n<span style=color:#ff79c6>;(</span>n <span style=color:#ff79c6>=</span> rd<span style=color:#ff79c6>.</span><span style=color:#50fa7b>read</span><span style=color:#ff79c6>(</span>chBuffer<span style=color:#ff79c6>))</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>-</span>1<span style=color:#ff79c6>;)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>n<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>            <span style=color:#6272a4>// 字符数组offset, len)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#6272a4></span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> String<span style=color:#ff79c6>(</span>chBuffer<span style=color:#ff79c6>,</span> 0<span style=color:#ff79c6>,</span> n<span style=color:#ff79c6>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>        <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>catch</span> <span style=color:#ff79c6>(</span>Exception e<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>    System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#6272a4>// 其他实现类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#6272a4>// CharArrayReader，内存中模拟Reader流，实际上是一个char[]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>Reader reader <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> CharArrayReader<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>toCharArray</span><span style=color:#ff79c6>()))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#6272a4>// StringReader， 可以直接把String当作输入流，和CharArrayReader几乎一样
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>Reader reader <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> StringReader<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#6272a4>// InputStream和Reader：Reader内部有一个InputStream，它先把数据以byte读入InputStream，再以特定的编码转换为char；可以手动转换，利用InputStreamReader
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#6272a4></span>InputStream input <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> FileInputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;src/readme.txt&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>Reader reader <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> InputStreamReader<span style=color:#ff79c6>(</span>input<span style=color:#ff79c6>,</span> <span style=color:#f1fa8c>&#34;UTF-8&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span style=color:#6272a4>// 简化代码，构造Reader时传入InputStream，这实际上时FileReader的一种实现方式
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span style=color:#6272a4></span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>Reader reader <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> InputStreamReader<span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> FileInputStream<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;src/readme.txt&#34;</span><span style=color:#ff79c6>),</span> <span style=color:#f1fa8c>&#34;UTF-8&#34;</span><span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>    <span style=color:#6272a4>// TODO:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
</code></pre></div><h3 id=printstreamprintwriter>PrintStream/PrintWriter</h3><p><strong>PrintStream</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>PrintStream`是一种`FilterOutputStream`，总是以byte数据输出；额外提供了一些写入各种数据<span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>,</span> <span style=color:#8be9fd>boolean</span><span style=color:#ff79c6>,</span> String<span style=color:#ff79c6>,</span> Object…<span style=color:#ff79c6>)</span>的方法`print<span style=color:#ff79c6>()/</span>println<span style=color:#ff79c6>()</span>`，除了提供了额外的方法外还有个特点就是不会抛出`IOException
</code></pre></div><blockquote><p><code>System.out.print</code>是系统默认提供的<code>PrintStream</code>， 表示标准输出</p><p><code>System.err</code>是系统默认提供的标准错误输出</p></blockquote><p><strong>PrintWriter</strong></p><p><code>PrintWriter</code>扩展了<code>Writer</code>接口，输出的是char数据，使用方法与<code>PrintStream</code>几乎一样</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>StringWriter buffer <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> StringWriter<span style=color:#ff79c6>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#ff79c6>try</span> <span style=color:#ff79c6>(</span>PrintWriter pw <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> PrintWriter<span style=color:#ff79c6>(</span>buffer<span style=color:#ff79c6>))</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>    pw<span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;Hello&#34;</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>    pw<span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>12345<span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>    pw<span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>true</span><span style=color:#ff79c6>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>buffer<span style=color:#ff79c6>.</span><span style=color:#50fa7b>toString</span><span style=color:#ff79c6>());</span>
</code></pre></div><p><a href=https://www.liaoxuefeng.com/>参考自廖雪峰的教程</a></p></div><div class=post-tags><nav class="nav tags"><ul class=flat><li><a href=/tags/java>java</a></li></ul></nav></div></div><div class="footer wrapper"><nav class=nav><div><a href=https://github.com/vividvilla/ezhil>Ezhil theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/katex.min.css integrity=sha384-r/BYDnh2ViiCwqZt5VJVWuADDic3NnnTIEOv4hOh05nSfB6tjWpKmn1kUHOVkMXc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/katex.min.js integrity=sha384-zDIgORxjImEWftZXZpWLs2l57fMX9B3yWFPN5Ecabe211Hm5ZG/OIz2b07DYPUcH crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></body></html>