<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Java类库 - Ari's home</title><link rel=icon type=image/png href=favicon.jpeg><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Java类库"><meta property="og:description" content="核心类与扩展类"><meta property="og:type" content="article"><meta property="og:url" content="https://ariliang.club/2020/02/java%E7%B1%BB%E5%BA%93/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-20T23:47:27+08:00"><meta property="article:modified_time" content="2020-02-20T23:47:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Java类库"><meta name=twitter:description content="核心类与扩展类"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://ariliang.club/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://ariliang.club/css/main.css><link rel=stylesheet type=text/css href=https://ariliang.club/css/dark.css media="(prefers-color-scheme: dark)"><script src=https://ariliang.club/js/feather.min.js></script><script src=https://ariliang.club/js/main.js></script></head><body><div class="container wrapper post"><div class=header><base href=https://ariliang.club/><h1 class=site-title><a href=https://ariliang.club/>Ari's home</a></h1><div class=site-description><nav class="nav social"><ul class=flat><a href=https://github.com/ariliang title=Github><i data-feather=github></i></a><a href=mailto://ariliangx@gmail.com title=Email><i data-feather=mail></i></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></div><div class=post-header><h1 class=title>Java类库</h1><div class=meta>Posted at &mdash; Feb 20, 2020</div></div><div class=desktoptoc><div class=post-toc><div class=toc-header>CATALOG</div><ul class=toc-h2><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#java%e6%a0%b8%e5%bf%83%e7%b1%bb class=toc-link>JAVA核心类</a></li><ul class=toc-h3><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%92%8c%e7%bc%96%e7%a0%81 class=toc-link>字符串和编码</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#stringbuilder class=toc-link>StringBuilder</a></li></ul><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#object class=toc-link>Object</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#%e5%ae%b9%e5%99%a8%e7%b1%bb class=toc-link>容器类</a></li><ul class=toc-h3><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#arrays class=toc-link>Arrays</a></li></ul><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#io class=toc-link>IO</a></li><ul class=toc-h3><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#filepath%e5%af%b9%e8%b1%a1 class=toc-link>File/Path对象</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#inputstreamoutputstream class=toc-link>InputStream/OutputStream</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#filter%e6%a8%a1%e5%bc%8f class=toc-link>Filter模式</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#%e8%af%bb%e5%8f%96classpath class=toc-link>读取classpath</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#%e5%ba%8f%e5%88%97%e5%8c%96 class=toc-link>序列化</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#readerwriter class=toc-link>Reader/Writer</a></li><li><a href=/2020/02/java%E7%B1%BB%E5%BA%93/#printstreamprintwriter class=toc-link>PrintStream/PrintWriter</a></li></div></div><div class=markdown><h1 id=java类库>Java类库</h1><h2 id=java核心类>JAVA核心类</h2><h3 id=字符串和编码>字符串和编码</h3><ol><li>实际上字符串内部是用<code>char[]</code>来表示的</li></ol><blockquote><p>比如<code>String s = new String(new char[] {'H', 'e', 'l', 'l', 'o', '!'});</code>
它的内部的字段定义是<code>private final char[]</code>，所以字符串对象是恒定不变的</p></blockquote><ol><li>字符串比较应该利用<code>equals()</code>而不是<code>==</code>，因为字符串是引用类型，<code>==</code>比较的是引用值</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#177500>// 比较内容，利用==比较也为true，是因为编译器会自动把相同的字符串当作一个对象放入常量池，自然引用&#34;hello&#34;和引用s的引用值是相等的
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#177500></span><span style=color:#000>String</span> <span style=color:#000>s</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;hello&#34;</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#a90d91>boolean</span> <span style=color:#000>isEqual1</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>equals</span><span style=color:#000>(</span><span style=color:#000>s</span><span style=color:#000>)</span> <span style=color:#000>?</span> <span style=color:#a90d91>true</span> <span style=color:#000>:</span> <span style=color:#a90d91>false</span><span style=color:#000>;</span>	<span style=color:#177500>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#177500></span><span style=color:#a90d91>boolean</span> <span style=color:#000>isEqual2</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;hello&#34;</span> <span style=color:#000>==</span> <span style=color:#000>s</span> <span style=color:#000>?</span> <span style=color:#a90d91>true</span> <span style=color:#000>:</span> <span style=color:#a90d91>false</span><span style=color:#000>;</span>			<span style=color:#177500>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#177500>// 比较内容，s与&#34;hello&#34;.toUpperCase()的引用不相同
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span style=color:#177500></span><span style=color:#000>String</span> <span style=color:#000>s</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;HELLO&#34;</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span style=color:#a90d91>boolean</span> <span style=color:#000>isEqual</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>toUpperCase</span><span style=color:#000>()</span> <span style=color:#000>==</span> <span style=color:#c41a16>&#34;s&#34;</span> <span style=color:#000>?</span> <span style=color:#a90d91>true</span> <span style=color:#000>:</span> <span style=color:#a90d91>false</span><span style=color:#000>;</span>	<span style=color:#177500>// false
</span></code></pre></div><ol><li>常用方法</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>equalsIgnoreCase</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>);</span>	<span style=color:#177500>// true，忽略大小写比较
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>contains</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;llo&#34;</span><span style=color:#000>);</span>			<span style=color:#177500>// true，是否包含某个子串，方法参数是CharSequence
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>indexOf</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;e&#34;</span><span style=color:#000>);</span>				<span style=color:#177500>// 1，子串的索引，由0开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>lastIndexOf</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;l&#34;</span><span style=color:#000>);</span>			<span style=color:#177500>// 3，最后一个字串的索引，0开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>startsWith</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;He&#34;</span><span style=color:#000>);</span>			<span style=color:#177500>// true，由某个字串开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500></span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>endsWith</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;lo&#34;</span><span style=color:#000>);</span>				<span style=color:#177500>// true，由某个字串结束
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#c41a16>&#34; \nHello\r\t&#34;</span><span style=color:#000>.</span><span style=color:#836c28>trim</span><span style=color:#000>();</span>				<span style=color:#177500>// &#34;Hello&#34;，去除首尾空白字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#177500></span><span style=color:#c41a16>&#34;\u3000Hello\u3000&#34;</span><span style=color:#000>.</span><span style=color:#836c28>strip</span><span style=color:#000>();</span>		<span style=color:#177500>// &#34;Hello&#34;，去除首尾空白字符，包括其他语言的，&#39;\u3000&#39;是中文的空格
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#177500></span><span style=color:#c41a16>&#34; Hello &#34;</span><span style=color:#000>.</span><span style=color:#836c28>stripLeading</span><span style=color:#000>();</span>			<span style=color:#177500>// &#34;Hello &#34;，去除头部空白字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#177500></span><span style=color:#c41a16>&#34; Hello &#34;</span><span style=color:#000>.</span><span style=color:#836c28>stripEnding</span><span style=color:#000>();</span>			<span style=color:#177500>// &#34; Hello&#34;，去除尾部空白字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#c41a16>&#34;&#34;</span><span style=color:#000>.</span><span style=color:#836c28>isEmpty</span><span style=color:#000>();</span>		<span style=color:#177500>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#177500></span><span style=color:#c41a16>&#34;  \n&#34;</span><span style=color:#000>.</span><span style=color:#836c28>isBlank</span><span style=color:#000>();</span>	<span style=color:#177500>// true
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>subString</span><span style=color:#000>(</span><span style=color:#000>2</span><span style=color:#000>);</span>				<span style=color:#177500>// &#34;llo&#34;，提取2到末尾的字串，索引从0开始
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#177500></span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>subString</span><span style=color:#000>(</span><span style=color:#000>2</span><span style=color:#000>,</span> <span style=color:#000>4</span><span style=color:#000>);</span>			<span style=color:#177500>// &#34;ll&#34;，2到3字串，4之前
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>replace</span><span style=color:#000>(</span><span style=color:#2300ce>&#39;l&#39;</span><span style=color:#000>,</span> <span style=color:#2300ce>&#39;w&#39;</span><span style=color:#000>);</span>			<span style=color:#177500>// &#34;hewwo&#34;，替换字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#177500></span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>replace</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;ll&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;~~&#34;</span><span style=color:#000>);</span>		<span style=color:#177500>// &#34;he~~o&#34;，所有&#34;ll&#34;替换为&#34;~~&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#177500>// 还有正则表达式的替换，待添加
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#000>String</span><span style=color:#000>[]</span> <span style=color:#000>arr</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;A,B,C,D&#34;</span><span style=color:#000>.</span><span style=color:#836c28>split</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;\\,&#34;</span><span style=color:#000>);</span>	<span style=color:#177500>// [&#34;A&#34;, &#34;B&#34;, &#34;C&#34;, &#34;D&#34;]，正则表达式来分割
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#177500></span><span style=color:#000>String</span> <span style=color:#000>s</span> <span style=color:#000>=</span> <span style=color:#000>String</span><span style=color:#000>.</span><span style=color:#836c28>join</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;***&#34;</span><span style=color:#000>,</span> <span style=color:#000>arr</span><span style=color:#000>);</span>		<span style=color:#177500>// &#34;A***B***C***D&#34;，拼接字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span style=color:#000>String</span><span style=color:#000>.</span><span style=color:#836c28>valueOf</span><span style=color:#000>(</span><span style=color:#000>123</span><span style=color:#000>);</span>	<span style=color:#177500>// 将其他类型转换为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span style=color:#177500></span><span style=color:#000>String</span><span style=color:#000>.</span><span style=color:#836c28>valueOf</span><span style=color:#000>(</span><span style=color:#000>35</span><span style=color:#000>.</span><span style=color:#836c28>43</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span style=color:#000>String</span><span style=color:#000>.</span><span style=color:#836c28>valueOf</span><span style=color:#000>(</span><span style=color:#a90d91>true</span><span style=color:#000>);</span>	<span style=color:#177500>// &#34;true&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#177500></span><span style=color:#000>String</span><span style=color:#000>.</span><span style=color:#836c28>valueOf</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>Object</span><span style=color:#000>());</span>	<span style=color:#177500>//	类似java.lang.Object@636be97c
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span style=color:#177500>// String可以和char[]相互转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span style=color:#177500></span><span style=color:#a90d91>char</span><span style=color:#000>[]</span> <span style=color:#000>cs</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>toCharArray</span><span style=color:#000>();</span>	<span style=color:#177500>// String --&gt; char[]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span style=color:#177500></span><span style=color:#000>String</span> <span style=color:#000>s</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>String</span><span style=color:#000>(</span><span style=color:#000>cs</span><span style=color:#000>);</span>			<span style=color:#177500>// char[] --&gt; String
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span style=color:#177500></span><span style=color:#a90d91>char</span><span style=color:#000>[</span><span style=color:#000>0</span><span style=color:#000>]</span> <span style=color:#000>=</span> <span style=color:#2300ce>&#39;X&#39;</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>s</span><span style=color:#000>);</span>		<span style=color:#177500>// &#34;Hello&#34;，修改了char[]后s并不会改变，因为两者是不同的对象。new String(char[]);是复制，若传入的对象有可能改变，那么是复制内容
</span></code></pre></div><ol><li>字符编码</li></ol><blockquote><ol><li>ASCII只有1个字节编码的范围是0~127(0000 0000~0111 1111)，高位始终为0</li><li>GB2312采用2字节，第一个高位始终为1以便和ASCII码区分(1000 0000 0000 0000 ~ 1111 1111 1111)</li><li>Unicode编码使用两个或更多字节，英文字符就是简单的在前面加00，因为这样会浪费空间，就出现了UTF-8，把固定长度的Unicode编码编程1~4字节的变长编码</li><li>UTF-8依靠高字节来确定一个字符究竟是几个字节，传输中容错能强，常用作传输编码</li><li>Java的String和char在内存中总是以Unicode表示</li></ol></blockquote><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// char类型实际上是两个字节的Unicode编码，可以手动把字符串转换为其他编码，转换后不再是char类型，而是byte型数组
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500>// 转换为byte[]类型的时候优先考虑UTF-8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#177500></span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b1</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>getBytes</span><span style=color:#000>();</span>		<span style=color:#177500>// 按ISO8859-1编码转换，不推荐
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#177500></span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b2</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>getBytes</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;UTF-8&#34;</span><span style=color:#000>);</span>		<span style=color:#177500>// 按UTF-8转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b3</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>getBytes</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;GBK&#34;</span><span style=color:#000>);</span>		<span style=color:#177500>// 按GBK转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#177500></span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b4</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>getBytes</span><span style=color:#000>(</span><span style=color:#000>StandardCharsets</span><span style=color:#000>.</span><span style=color:#836c28>UTF_8</span><span style=color:#000>);</span>	<span style=color:#177500>// 按UTF-8转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500>// 将已知的byte型数组转化为String
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500></span><span style=color:#000>String</span> <span style=color:#000>s1</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>String</span><span style=color:#000>(</span><span style=color:#000>b3</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;GBK&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#000>String</span> <span style=color:#000>s2</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>String</span><span style=color:#000>(</span><span style=color:#000>b4</span><span style=color:#000>,</span> <span style=color:#000>StandardCharsets</span><span style=color:#000>.</span><span style=color:#836c28>UTF_8</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#177500>// 早期的String内部由char[]实现，而现在内部是byte[]，因为许多情况下只有ASCII内容，而使用char[]会浪费内存，利用byte[]能够存储一个字节，更节约
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#177500></span><span style=color:#a90d91>private</span> <span style=color:#a90d91>final</span> <span style=color:#a90d91>char</span><span style=color:#000>[]</span> <span style=color:#000>value</span><span style=color:#000>;</span>  <span style=color:#000>--&gt;</span>  <span style=color:#a90d91>private</span> <span style=color:#a90d91>final</span> <span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>value</span><span style=color:#000>;</span>
</code></pre></div><h3 id=stringbuilder>StringBuilder</h3><ol><li>java对String做了特殊处理，可以直接使用<code>+</code>拼接字符串</li><li>构造复杂的字符串利用<code>StringBuilder</code></li></ol><h2 id=object>Object</h2><p>方法列表</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#177500>// toString();	将内容输出为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#177500>// equals();	判断是否逻辑相等
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#177500>// hashCode();	计算instance的hash值
</span></code></pre></div><h2 id=容器类>容器类</h2><h3 id=arrays>Arrays</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#177500>// 将数值类型转化为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#177500></span><span style=color:#000>Arrays</span><span style=color:#000>.</span><span style=color:#836c28>toString</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#000>Arrays</span><span style=color:#000>.</span><span style=color:#836c28>deepToString</span><span style=color:#000>();</span>	<span style=color:#177500>// 输出多维数组为字符串
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#177500>// 排序，若是对基本类型数组排序，则改变了数组元素的的位置。
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#177500>// 若是对引用类型排序，如字符串，则改变了索引的引用值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span style=color:#177500></span><span style=color:#000>Arrays</span><span style=color:#000>.</span><span style=color:#836c28>sort</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>
</code></pre></div><h2 id=io>IO</h2><ol><li><p>IO是指内存和外部硬盘，网络等的数据交换，以内存为中心；实际上在内存中以某种数据结构表示，如<code>byte[]</code>，<code>String</code></p></li><li><p>IO分为同步和异步，分别在包<code>java.io</code>和<code>java.nio</code>中；同步指必须在IO结束后才能继续后续步骤，异步指只是发出IO请求，立刻执行后续步骤</p></li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 同步IO
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#a90d91>import</span> <span style=color:#000>java.io</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#177500>/* 
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500>* 抽象类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#177500>* 	InputStream/OutputStream, Reader/Writer
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#177500>* 实现类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500>* 	FileInputStream/FileOutputStream, FileReader/FileWriter
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500>*/</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#177500>// 异步IO
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#177500></span><span style=color:#a90d91>import</span> <span style=color:#000>java.nio</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#177500>/*
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#177500>*	Path/Paths
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#177500>*
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#177500>*/</span>
</code></pre></div><h3 id=filepath对象>File/Path对象</h3><p>利用<code>File</code>来操作文件和目录，<code>File</code>既可以表示文件，也可以表示目录；构造<code>File</code>时只是构造对象，不会进行任何IO操作，所以不会报错。而在调用的时候，才会有磁盘操作</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 要构造一个File对象需要传入文件/目录路径，可以是绝对路径，也可以是相对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#000>File</span> <span style=color:#000>f1</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>File</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;D:\\Downloads&#34;</span><span style=color:#000>);</span>	<span style=color:#177500>// Win下，绝对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#177500></span><span style=color:#000>File</span> <span style=color:#000>f2</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>File</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;/home/user&#34;</span><span style=color:#000>);</span>		<span style=color:#177500>// unix下
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#177500></span><span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>File</span><span style=color:#000>.</span><span style=color:#836c28>separator</span><span style=color:#000>)</span>		<span style=color:#177500>// 返回当前OS分隔符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span><span style=color:#000>File</span> <span style=color:#000>f3</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>File</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./dir&#34;</span><span style=color:#000>);</span>			<span style=color:#177500>// 相对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#177500></span><span style=color:#000>File</span> <span style=color:#000>f4</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>Fifle</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;../test&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500>// 利用File对象获取三种路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>getPath</span><span style=color:#000>();</span>			<span style=color:#177500>// (String)返回构造方法传入的路径：./Downloads
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>getAbsoluttePath</span><span style=color:#000>/</span><span style=color:#000>File</span><span style=color:#000>();</span>	<span style=color:#177500>// (String/File)返回绝对路径：类似 D:\Downloads\..\Downloa
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#177500></span><span style=color:#000>ds</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>getCanonicalPath</span><span style=color:#000>/</span><span style=color:#000>File</span><span style=color:#000>();</span>	<span style=color:#177500>// (String/File)返回绝对规范路径：类似 D:\Downloads
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>getName</span><span style=color:#000>();</span>				<span style=color:#177500>// String，返回文件或目录的名字
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#177500>// 文件或目录操作，在调用这些方法的时候才会进行实际的磁盘访问
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>exists</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>isFile</span><span style=color:#000>();</span>			<span style=color:#177500>// 是否是文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>diDirectory</span><span style=color:#000>();</span>	<span style=color:#177500>// 是否是目录
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>canRead</span><span style=color:#000>();</span>		<span style=color:#177500>// boolean
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>canWrite</span><span style=color:#000>();</span>		<span style=color:#177500>// boolean
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>canExecute</span><span style=color:#000>();</span>		<span style=color:#177500>// boolean，目录的话代表是否可以列出其子目录和文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>lastModified</span><span style=color:#000>();</span>	<span style=color:#177500>// long，返回上次修改时间
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>setReadable</span><span style=color:#000>(</span><span style=color:#a90d91>true</span><span style=color:#000>);</span>	<span style=color:#177500>// 设置可读，同样还有可写，可执行，修改上次修改时间
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>length</span><span style=color:#000>();</span>			<span style=color:#177500>// long，文件字节大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>getFreeSpace</span><span style=color:#000>/</span><span style=color:#000>TotalSpace</span><span style=color:#000>/</span><span style=color:#000>UsableSpace</span><span style=color:#000>();</span>	<span style=color:#177500>// long, 返回空间大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>createNewFile</span><span style=color:#000>();</span>	<span style=color:#177500>// 创建新文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span style=color:#177500></span><span style=color:#000>File</span> <span style=color:#000>f</span> <span style=color:#000>=</span> <span style=color:#000>File</span><span style=color:#000>.</span><span style=color:#836c28>createTempFile</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;tmp-&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;.txt&#34;</span><span style=color:#000>);</span>	<span style=color:#177500>// 创建临时文件，指定前缀和后缀，类似 temp-342556345.txt
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>delete</span><span style=color:#000>();</span>			<span style=color:#177500>// 删除文件或目录，删除目录时必须为空
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>deleteOnExit</span><span style=color:#000>();</span>	<span style=color:#177500>// JVM退出时自动删除
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span style=color:#177500></span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>mkdir</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>mkdirs</span><span style=color:#000>();</span>			<span style=color:#177500>// 级联创建目录
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span style=color:#177500>// 遍历文件和目录
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span style=color:#177500></span><span style=color:#000>String</span><span style=color:#000>[]</span> <span style=color:#000>fl</span> <span style=color:#000>=</span> <span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>list</span><span style=color:#000>();</span>		<span style=color:#177500>// String[]，同上，以String数组返回
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span style=color:#177500></span><span style=color:#000>File</span><span style=color:#000>[]</span> <span style=color:#000>fl</span> <span style=color:#000>=</span> <span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>listFiles</span><span style=color:#000>();</span>	<span style=color:#177500>// File[]，列出所有文件和目录，以File数组形式返回
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span style=color:#177500></span><span style=color:#000>File</span><span style=color:#000>[]</span> <span style=color:#000>fl</span> <span style=color:#000>=</span> <span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>listFiles</span><span style=color:#000>(</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span>    <span style=color:#a90d91>new</span> <span style=color:#000>FilenameFilter</span><span style=color:#000>()</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span>        <span style=color:#a90d91>public</span> <span style=color:#a90d91>boolean</span> <span style=color:#000>accept</span><span style=color:#000>(</span><span style=color:#000>File</span> <span style=color:#000>dir</span><span style=color:#000>,</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span>            <span style=color:#a90d91>return</span> <span style=color:#000>name</span><span style=color:#000>.</span><span style=color:#836c28>endWith</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;.exe&#34;</span><span style=color:#000>);</span>  <span style=color:#177500>// 仅列出该类型文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span style=color:#177500></span>        <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span style=color:#000>);</span>		<span style=color:#177500>// 传入一个过滤对象，过滤不必要的文件或目录
</span></code></pre></div><p>可以利用Path类来更轻松地创建路径<code>java.nio.file.Path/Paths</code></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 构造一个路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#000>Path</span> <span style=color:#000>p</span> <span style=color:#000>=</span> <span style=color:#000>Paths</span><span style=color:#000>.</span><span style=color:#836c28>get</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;.&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;Downloads&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;temp&#34;</span><span style=color:#000>);</span>	<span style=color:#177500>// Path，返回一个Path对象，其路径为 ./Downloads/temp
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#177500></span><span style=color:#000>p</span> <span style=color:#000>=</span> <span style=color:#000>p</span><span style=color:#000>.</span><span style=color:#836c28>toAbsolutePath</span><span style=color:#000>();</span>		<span style=color:#177500>// Path，返回绝对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#177500></span><span style=color:#000>p</span> <span style=color:#000>=</span> <span style=color:#000>p</span><span style=color:#000>.</span><span style=color:#836c28>normalize</span><span style=color:#000>();</span>			<span style=color:#177500>// Path，返回标准路径（不是绝对的）；要先 toAbsolutePath()，再 normalize()，才能得到标准的绝对路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#177500>// 与File对象相互转换
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#177500></span><span style=color:#000>File</span> <span style=color:#000>f</span> <span style=color:#000>=</span> <span style=color:#000>p</span><span style=color:#000>.</span><span style=color:#836c28>toFile</span><span style=color:#000>();</span>		<span style=color:#177500>// File，返回File对象
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500></span><span style=color:#000>p</span> <span style=color:#000>=</span> <span style=color:#000>f</span><span style=color:#000>.</span><span style=color:#836c28>toPath</span><span style=color:#000>();</span>				<span style=color:#177500>// Path，返回Path对象
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#177500>// 遍历
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#177500></span><span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#000>Path</span> <span style=color:#000>p</span> <span style=color:#000>:</span> <span style=color:#000>Paths</span><span style=color:#000>.</span><span style=color:#836c28>get</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;..&#34;</span><span style=color:#000>).</span><span style=color:#836c28>toAbsolutePath</span><span style=color:#000>())</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>print</span><span style=color:#000>(</span><span style=color:#000>p</span> <span style=color:#000>+</span> <span style=color:#c41a16>&#34;, &#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#000>}</span>	<span style=color:#177500>// 构造成 */*/.. 路径，再把其变为绝对路径拆开输出：*, *, ..
</span></code></pre></div><h3 id=inputstreamoutputstream>InputStream/OutputStream</h3><p><code>InputSteam/OutputStream</code>：IO流以<em>字节*为单位(byte)，因此也称为字节流；<code>InputStream</code>表示输入流，<code>OutputStream</code>表示输出流，是两种基本的流；*它们的特点是像水流一样单向流动</em>
它们并不是接口，而是抽象类，是一切输入输出流的超类</p><p><strong>InputStream</strong></p><p>定义了一个重要的抽象方法 <code>pubilc abstract int read() throws IOException;</code>这个抽象方法会读出下一个字节，以int返回(0~255)，读到末尾-1表示</p><p>在调用read()时是阻塞(Blocking)的，即IO未完成之前不会执行后续步骤</p><blockquote><p>实现类：</p><p><code>FileInputStream</code>文件输入流</p><p><code>ByteArrayInputStream</code>在内存中模拟一个输入流，实际上是把<code>byte[]</code>当作<code>InputStream</code>，可以用于测试</p></blockquote><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 实现类 FileInputStream 文件输入流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500>// 打开资源并使用后一定要记得关闭，下面展示了一个最简单的方法，但不是最常用的
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>void</span> <span style=color:#000>readFile</span><span style=color:#000>()</span> <span style=color:#a90d91>throws</span> <span style=color:#000>IOException</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>   <span style=color:#000>InputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./text.txt&#34;</span><span style=color:#000>);</span>   <span style=color:#177500>// 传入文件路径
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span>   <span style=color:#a90d91>for</span> <span style=color:#000>(;;)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>      <span style=color:#a90d91>int</span> <span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>();</span>   <span style=color:#177500>// 读出下一个byte值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#177500></span>      <span style=color:#a90d91>if</span> <span style=color:#000>(</span><span style=color:#000>n</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>         <span style=color:#a90d91>break</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>      <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>      <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>n</span><span style=color:#000>);</span>  <span style=color:#177500>// 打印byte的值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#177500></span>   <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>   <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>close</span><span style=color:#000>();</span>    <span style=color:#177500>// 关闭流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#177500></span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#177500>// 文件输入输出流不管是否成功或失败，都需要及时关闭资源
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>void</span> <span style=color:#000>readFile</span><span style=color:#000>()</span> <span style=color:#a90d91>throws</span> <span style=color:#000>IOException</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>   <span style=color:#000>InputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>null</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>   <span style=color:#a90d91>try</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>      <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./text.txt&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>      <span style=color:#a90d91>for</span><span style=color:#000>(</span><span style=color:#a90d91>int</span> <span style=color:#000>n</span><span style=color:#000>;</span> <span style=color:#000>(</span><span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>())</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>;)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>         <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>n</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>      <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>   <span style=color:#000>}</span> <span style=color:#a90d91>finally</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>      <span style=color:#a90d91>if</span> <span style=color:#000>(</span><span style=color:#000>input</span> <span style=color:#000>!=</span> <span style=color:#a90d91>null</span><span style=color:#000>)</span> <span style=color:#000>{</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>close</span><span style=color:#000>();</span> <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>   <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#177500>// 利用try(resources)来自动关闭资源，常用(JAVA 7引入)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>void</span> <span style=color:#000>readFile</span><span style=color:#000>()</span> <span style=color:#000>IOException</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>   <span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>InputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./text.txt&#34;</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>      <span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#a90d91>int</span> <span style=color:#000>n</span><span style=color:#000>;(</span><span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>())</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>         <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>n</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>      <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>   <span style=color:#000>}</span>  <span style=color:#177500>// 自动关闭，决定于try()里边的对象是否实现了java.lang.AutoClosable接口，里边有finally，并调用close()
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span style=color:#177500></span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span style=color:#177500>// 一次读取一个字节不是高效的办法，利用缓冲可以一次读取多个字节；每次会读满buffer.length个字节，然后清空之前读的字节，记录读到的位置，直到整个文件读完
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span style=color:#177500></span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>buffer</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#a90d91>byte</span><span style=color:#000>[</span><span style=color:#000>1000</span><span style=color:#000>];</span>        <span style=color:#177500>// 定义一个buffer，每次读取字节数不会超过这个数组的大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span style=color:#177500></span><span style=color:#a90d91>int</span> <span style=color:#000>read</span><span style=color:#000>(</span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b</span><span style=color:#000>);</span>                    <span style=color:#177500>// 读取若干字节填充到byte[]，返回读取的字节数，返回-1表示没有更多的字节了
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span style=color:#177500></span><span style=color:#a90d91>int</span> <span style=color:#000>read</span><span style=color:#000>(</span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b</span><span style=color:#000>,</span> <span style=color:#a90d91>int</span> <span style=color:#000>off</span><span style=color:#000>,</span> <span style=color:#a90d91>int</span> <span style=color:#000>len</span><span style=color:#000>);</span>  <span style=color:#177500>// 同时指定偏移量和最大填充数
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>void</span> <span style=color:#000>readFile</span><span style=color:#000>(){</span>		<span style=color:#177500>// 缓冲读取完整步骤
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span style=color:#177500></span>    <span style=color:#177500>// 利用缓冲读取字节流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span style=color:#177500></span>    <span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>btBuffer</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#a90d91>byte</span><span style=color:#000>[</span><span style=color:#000>1000</span><span style=color:#000>];</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span>    <span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>InputStream</span> <span style=color:#000>fs</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./text.txt&#34;</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span>        <span style=color:#177500>// read()返回的是读取的长度
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span style=color:#177500></span>        <span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#a90d91>int</span> <span style=color:#000>n</span><span style=color:#000>;</span> <span style=color:#000>(</span><span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>fs</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>(</span><span style=color:#000>btBuffer</span><span style=color:#000>))</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>;){</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span>            <span style=color:#177500>// byte数组输出为字符串的时候必须指定(offset, len, charset)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span style=color:#177500></span>            <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>String</span><span style=color:#000>(</span><span style=color:#000>btBuffer</span><span style=color:#000>,</span> <span style=color:#000>0</span><span style=color:#000>,</span> <span style=color:#000>n</span><span style=color:#000>,</span> <span style=color:#000>StandardCharsets</span><span style=color:#000>.</span><span style=color:#836c28>UTF_8</span><span style=color:#000>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span>        <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span>    <span style=color:#000>}</span> <span style=color:#a90d91>catch</span> <span style=color:#000>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#000>)</span> <span style=color:#000>{}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span>    <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span style=color:#177500>// ByteArrayInputStream，模拟输入流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span style=color:#177500></span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>data</span> <span style=color:#000>=</span> <span style=color:#000>{</span> <span style=color:#000>72</span><span style=color:#000>,</span> <span style=color:#000>101</span><span style=color:#000>,</span> <span style=color:#000>108</span><span style=color:#000>,</span> <span style=color:#000>108</span><span style=color:#000>,</span> <span style=color:#000>111</span><span style=color:#000>,</span> <span style=color:#000>33</span> <span style=color:#000>};</span>		<span style=color:#177500>// 构造byte[]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span style=color:#177500>// 从byte[]中输入
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>InputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>ByteArrayInputStream</span><span style=color:#000>(</span><span style=color:#000>data</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span>    <span style=color:#a90d91>int</span> <span style=color:#000>n</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span>    <span style=color:#a90d91>while</span> <span style=color:#000>((</span><span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>())</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span>        <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>((</span><span style=color:#a90d91>char</span><span style=color:#000>)</span><span style=color:#000>n</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span style=color:#000>}</span>
</code></pre></div><p><strong>OutputStream</strong></p><p>这个抽象类定义了一个重要的方法<code>public abstract void write(int b) throws IOException</code>每次写入一个字节byte</p><p>因为它先把写入的字节放到缓冲区而不是真正的写入，当缓冲区写满时才会把缓冲区写入，它还提供了另外一个方法<code>flush()</code>，利用它可以立即把缓冲区写入到文件，网络等</p><p>在调用<code>close()</code>的时候会自动调用<code>flush()</code></p><p>OutputStream也是阻塞的</p><blockquote><p>实现类：</p><p><code>FileOutputStream</code>文件输出流</p><p><code>ByteArrayOutputStream</code>内存模拟输出流</p></blockquote><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// write()每次写入一个字节，或一个byte[],写入后会覆盖原文件内容
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>{</span><span style=color:#2300ce>&#39;e&#39;</span><span style=color:#000>,</span> <span style=color:#2300ce>&#39;l&#39;</span><span style=color:#000>,</span> <span style=color:#2300ce>&#39;l&#39;</span><span style=color:#000>,</span> <span style=color:#2300ce>&#39;o&#39;</span><span style=color:#000>};</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#000>String</span> <span style=color:#000>s</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;world!&#34;</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#000>OutputStream</span> <span style=color:#000>output</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./text.txt&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>write</span><span style=color:#000>(</span><span style=color:#2300ce>&#39;h&#39;</span><span style=color:#000>);</span>				<span style=color:#177500>// char/int
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#177500></span><span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>write</span><span style=color:#000>(</span><span style=color:#000>43</span><span style=color:#000>);</span>				<span style=color:#177500>// 0~255
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#177500></span><span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>write</span><span style=color:#000>(</span><span style=color:#000>b</span><span style=color:#000>,</span> <span style=color:#000>0</span><span style=color:#000>,</span> <span style=color:#000>b</span><span style=color:#000>.</span><span style=color:#836c28>length</span><span style=color:#000>);</span>	<span style=color:#177500>// (byte[], offset, len)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500></span><span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>write</span><span style=color:#000>(</span><span style=color:#000>s</span><span style=color:#000>.</span><span style=color:#836c28>getBytes</span><span style=color:#000>(</span><span style=color:#000>StandardCharsets</span><span style=color:#000>.</span><span style=color:#836c28>UTF_8</span><span style=color:#000>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>close</span><span style=color:#000>();</span>					<span style=color:#177500>// 关闭输出流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#177500></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#177500>// 同样的，应该把文件的输出流放在try(resources)中，会自动关闭文件
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>OutputStream</span> <span style=color:#000>output</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./text.txt&#34;</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    <span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>write</span><span style=color:#000>(</span><span style=color:#2300ce>&#39;h&#39;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#000>}</span> <span style=color:#a90d91>catch</span> <span style=color:#000>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#000>)</span> <span style=color:#000>{}</span>
</code></pre></div><h3 id=filter模式>Filter模式</h3><p>通过基础组件再叠加各种附加功能组件的模式，叫做Filter模式，或者装饰器(Decorator)模式；如图，各种<code>*InputStream</code>都可以用<code>InputStream</code>来使用，而且仅仅是在基础的数据录入源的基础上增添功能，若每个附加的功能都写一个类，那样会使类的数量大大增</p><p><img src=images/Java%E7%B1%BB%E5%BA%93/Filter-mod.png alt=Filer-mod></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 编写 FilterInputStream 扩展类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>class</span> <span style=color:#3f6e75>Main</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#a90d91>public</span> <span style=color:#a90d91>static</span> <span style=color:#a90d91>void</span> <span style=color:#000>main</span><span style=color:#000>(</span><span style=color:#000>String</span><span style=color:#000>[]</span> <span style=color:#000>args</span><span style=color:#000>)</span> <span style=color:#a90d91>throws</span> <span style=color:#000>IOException</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>        <span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>data</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;hello, world!&#34;</span><span style=color:#000>.</span><span style=color:#836c28>getBytes</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;UTF-8&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>        <span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>CountInputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>CountInputStream</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>ByteArrayInputStream</span><span style=color:#000>(</span><span style=color:#000>data</span><span style=color:#000>)))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>            <span style=color:#a90d91>int</span> <span style=color:#000>n</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>            <span style=color:#a90d91>while</span> <span style=color:#000>((</span><span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>())</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>                <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>((</span><span style=color:#a90d91>char</span><span style=color:#000>)</span><span style=color:#000>n</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>            <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>            <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Total read &#34;</span> <span style=color:#000>+</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>getBytesRead</span><span style=color:#000>()</span> <span style=color:#000>+</span> <span style=color:#c41a16>&#34; bytes&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>        <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#a90d91>class</span> <span style=color:#3f6e75>CountInputStream</span> <span style=color:#a90d91>extends</span> <span style=color:#000>FilterInputStream</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    <span style=color:#a90d91>private</span> <span style=color:#a90d91>int</span> <span style=color:#000>count</span> <span style=color:#000>=</span> <span style=color:#000>0</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>    <span style=color:#000>CountInputStream</span><span style=color:#000>(</span><span style=color:#000>InputStream</span> <span style=color:#000>in</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>        <span style=color:#a90d91>super</span><span style=color:#000>(</span><span style=color:#000>in</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>    <span style=color:#a90d91>public</span> <span style=color:#a90d91>int</span> <span style=color:#000>getBytesRead</span><span style=color:#000>()</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>        <span style=color:#a90d91>return</span> <span style=color:#a90d91>this</span><span style=color:#000>.</span><span style=color:#836c28>count</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>    <span style=color:#a90d91>public</span> <span style=color:#a90d91>int</span> <span style=color:#000>read</span><span style=color:#000>()</span> <span style=color:#a90d91>throws</span> <span style=color:#000>IOException</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>        <span style=color:#a90d91>int</span> <span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>in</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>        <span style=color:#a90d91>if</span> <span style=color:#000>(</span><span style=color:#000>n</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>            <span style=color:#a90d91>this</span><span style=color:#000>.</span><span style=color:#836c28>count</span> <span style=color:#000>++;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>        <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>        <span style=color:#a90d91>return</span> <span style=color:#000>n</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>    <span style=color:#a90d91>public</span> <span style=color:#a90d91>int</span> <span style=color:#000>read</span><span style=color:#000>(</span><span style=color:#a90d91>byte</span><span style=color:#000>[]</span> <span style=color:#000>b</span><span style=color:#000>,</span> <span style=color:#a90d91>int</span> <span style=color:#000>off</span><span style=color:#000>,</span> <span style=color:#a90d91>int</span> <span style=color:#000>len</span><span style=color:#000>)</span> <span style=color:#a90d91>throws</span> <span style=color:#000>IOException</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>        <span style=color:#a90d91>int</span> <span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>in</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>(</span><span style=color:#000>b</span><span style=color:#000>,</span> <span style=color:#000>off</span><span style=color:#000>,</span> <span style=color:#000>len</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span>        <span style=color:#a90d91>this</span><span style=color:#000>.</span><span style=color:#836c28>count</span> <span style=color:#000>+=</span> <span style=color:#000>n</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>        <span style=color:#a90d91>return</span> <span style=color:#000>n</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span style=color:#000>}</span>
</code></pre></div><p>操作Zip，它是一种 <code>FilterInputStream</code>；另外<code>JarInputStream</code>派生自 <code>ZipInputStream</code>，是在zip的基础上增加对<code>MANIFEST.MF</code>文件的读写</p><p><img src=images/Java%E7%B1%BB%E5%BA%93/filter-zip.png alt=filter-zip></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 读取压缩包内容
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>ZipInputStream</span> <span style=color:#000>zip</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>ZipInputStream</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./zip.zip&#34;</span><span style=color:#000>)))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#000>ZipEntry</span> <span style=color:#000>entry</span><span style=color:#000>;</span> <span style=color:#000>(</span><span style=color:#000>entry</span> <span style=color:#000>=</span> <span style=color:#000>zip</span><span style=color:#000>.</span><span style=color:#836c28>getNextEntry</span><span style=color:#000>())</span> <span style=color:#000>!=</span> <span style=color:#a90d91>null</span><span style=color:#000>;</span> <span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>        <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>print</span><span style=color:#000>(</span><span style=color:#000>entry</span><span style=color:#000>.</span><span style=color:#836c28>getName</span><span style=color:#000>());</span>		<span style=color:#177500>// 获取压缩包内部文件或目录的名字
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span>        <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>print</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;, &#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>        <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>print</span><span style=color:#000>(</span><span style=color:#000>entry</span><span style=color:#000>.</span><span style=color:#836c28>getTime</span><span style=color:#000>());</span>		<span style=color:#177500>// 获取内容的时间
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#177500></span>        <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>print</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;, &#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>        <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>entry</span><span style=color:#000>.</span><span style=color:#836c28>getSize</span><span style=color:#000>());</span>	<span style=color:#177500>// 获取压缩前内容的大小
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500></span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#000>}</span> <span style=color:#a90d91>catch</span> <span style=color:#000>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>    <span style=color:#177500>//TODO: handle exception
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#177500></span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#177500>// 写入压缩包
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>ZipOutputStream</span> <span style=color:#000>zip</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>ZipOutputStream</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#000>(...)))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    <span style=color:#000>File</span><span style=color:#000>[]</span> <span style=color:#000>files</span> <span style=color:#000>=</span> <span style=color:#000>...</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    <span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#000>File</span> <span style=color:#000>file</span> <span style=color:#000>:</span> <span style=color:#000>files</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>        <span style=color:#000>zip</span><span style=color:#000>.</span><span style=color:#836c28>putNextEntry</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>ZipEntry</span><span style=color:#000>(</span><span style=color:#000>file</span><span style=color:#000>.</span><span style=color:#836c28>getName</span><span style=color:#000>()));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>        <span style=color:#000>zip</span><span style=color:#000>.</span><span style=color:#836c28>write</span><span style=color:#000>(</span><span style=color:#000>getFileDataAsBytes</span><span style=color:#000>(</span><span style=color:#000>file</span><span style=color:#000>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>        <span style=color:#000>zip</span><span style=color:#000>.</span><span style=color:#836c28>closeEntry</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#000>}</span>
</code></pre></div><h3 id=读取classpath>读取<code>classpath</code></h3><p>经常读取配置文件，且每次写磁盘路径很麻烦，可以利用<code>classpath</code>而不用关心具体的路径，这样就解决了文件路径依赖。它的路径从<code>/</code>开始，可以包含任意其他类型格式</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 先获取到当前Class对象，getResourceAsStream()当对象不存在时返回null
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>InputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#000>getClass</span><span style=color:#000>().</span><span style=color:#836c28>getResourceAsStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;/default.properties&#34;</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#a90d91>if</span> <span style=color:#000>(</span><span style=color:#000>input</span> <span style=color:#000>!=</span> <span style=color:#a90d91>null</span><span style=color:#000>)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>        <span style=color:#177500>// TODO
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span>    <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500>// 默认的配置在jar包中，若有用户配置，则读取用户配置
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500></span><span style=color:#000>Properties</span> <span style=color:#000>props</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>Properties</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#000>props</span><span style=color:#000>.</span><span style=color:#836c28>load</span><span style=color:#000>(</span><span style=color:#000>inputStreamFromClassPath</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;/default.properties&#34;</span><span style=color:#000>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#000>props</span><span style=color:#000>.</span><span style=color:#836c28>load</span><span style=color:#000>(</span><span style=color:#000>inputStreamFromFile</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./conf.properties&#34;</span><span style=color:#000>));</span>
</code></pre></div><h3 id=序列化>序列化</h3><p>序列化就是把java对象编程二进制内容，本质就是一个<code>byte[]</code>，因为序列化后可以把对象保存到文件中，便于传输</p><p>反序列化时由<code>byte[]</code>直接生成对象，不会调用构造方法，但是这个过程中会产生安全问题；而且Java的序列化机制仅适用于Java，要和其他语言交换数据，要使用通用的序列化方法：如 Json，只输出基本类型和String</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 要实现对象的序列化，必须实现一个特殊接口 java.io.Serializable；它没有定义任何方法，是一个空接口，称这种接口叫做标记接口
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>interface</span> <span style=color:#3f6e75>Serializable</span> <span style=color:#000>{}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#177500>// 序列化需要使用 ObjectOutputStream，它可以写入基本类型如int/boolean，也可以写入String等；还可以写入实现了 Sreierializeable 接口的 Object，写入 Object 需要大量信息，所以内容很大
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#177500></span><span style=color:#000>ByteArrayOutputStream</span> <span style=color:#000>buffer</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>ByteArrayOutputStream</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>ObjectOutputStream</span> <span style=color:#000>output</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>ObjectOutputStream</span><span style=color:#000>(</span><span style=color:#000>buffer</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>    <span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>writeInt</span><span style=color:#000>(</span><span style=color:#000>12345</span><span style=color:#000>);</span>			<span style=color:#177500>// 写入int:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500></span>    <span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>writeUTF</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>);</span>		<span style=color:#177500>// 写入String:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#177500></span>    <span style=color:#000>output</span><span style=color:#000>.</span><span style=color:#836c28>writeObject</span><span style=color:#000>(</span><span style=color:#000>Double</span><span style=color:#000>.</span><span style=color:#836c28>valueOf</span><span style=color:#000>(</span><span style=color:#000>123</span><span style=color:#000>.</span><span style=color:#836c28>456</span><span style=color:#000>));</span>	<span style=color:#177500>// 写入Object:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#177500></span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>Arrays</span><span style=color:#000>.</span><span style=color:#836c28>toString</span><span style=color:#000>(</span><span style=color:#000>buffer</span><span style=color:#000>.</span><span style=color:#836c28>toByteArray</span><span style=color:#000>()));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#177500>// 反序列化，调用 readObject() 可以直接返回一个对象，必须强制转型；反序列化时是直接构造出 Object，不会调用其构造方法，导致了安全性问题
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>ObjectInputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>ObjectInputStream</span><span style=color:#000>(...))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>    <span style=color:#a90d91>int</span> <span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>readInt</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    <span style=color:#000>String</span> <span style=color:#000>s</span> <span style=color:#000>=</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>readUTF</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    <span style=color:#000>Double</span> <span style=color:#000>d</span> <span style=color:#000>=</span> <span style=color:#000>(</span><span style=color:#000>Double</span><span style=color:#000>)</span> <span style=color:#000>input</span><span style=color:#000>.</span><span style=color:#836c28>readObject</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#177500>// 序列化和反序列化过程中很可能发生一些错误
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#177500></span><span style=color:#000>ClassNotFoundException</span><span style=color:#000>;</span>		<span style=color:#177500>// 反序列化时没有对应的类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#177500></span><span style=color:#000>InvalidClassException</span><span style=color:#000>;</span>		<span style=color:#177500>// Class不匹配，比如 int 和 long 不匹配
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#177500>// 所以序列化时允许 Class 定义一个特殊的 ID；静态变量 serialVersionUID(非必须)，用于标识序列化的版本，通常由IDE生成；如果增加或修改了字段，就可以改变其值
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>class</span> <span style=color:#3f6e75>Person</span> <span style=color:#a90d91>implements</span> <span style=color:#000>Serializable</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>    <span style=color:#a90d91>private</span> <span style=color:#a90d91>static</span> <span style=color:#a90d91>final</span> <span style=color:#a90d91>long</span> <span style=color:#000>serialVersionUID</span> <span style=color:#000>=</span> <span style=color:#000>2709425275741743919L</span><span style=color:#000>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#000>}</span>
</code></pre></div><h3 id=readerwriter>Reader/Writer</h3><p>若要读写的是字符(char)，且字符不全是单字节表示的ASCII，那么按照<code>char</code>来读写更方便，这种流称为字符流；其本质是一个能自动编解码的<code>InputStream/OutputStream</code>，会自动地在byte和char之间转换，<em>需指定编码方式</em></p><p><strong>Reader</strong></p><p>操作大概与<code>InputStream</code>类似</p><p><img src=images/Java%E7%B1%BB%E5%BA%93/comparasion-between-inputstream-and-reader.png alt=comparasion-between-inputstream-and-reader></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#177500>// 同样的，可以利用缓冲，一次读取多个字符
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#177500></span><span style=color:#a90d91>public</span> <span style=color:#a90d91>void</span> <span style=color:#000>readFile</span><span style=color:#000>(){</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#177500>// 利用缓冲读取字符流
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#177500></span>    <span style=color:#a90d91>char</span><span style=color:#000>[]</span> <span style=color:#000>chBuffer</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#a90d91>char</span><span style=color:#000>[</span><span style=color:#000>1000</span><span style=color:#000>];</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>    <span style=color:#177500>// 构造时传入文件路径和编码方式
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#177500></span>    <span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>Reader</span> <span style=color:#000>rd</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileReader</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;./text.txt&#34;</span><span style=color:#000>,</span> <span style=color:#000>StandardCharsets</span><span style=color:#000>.</span><span style=color:#836c28>UTF_8</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>        <span style=color:#177500>// read()返回的是读取字符个数
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#177500></span>        <span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#a90d91>int</span> <span style=color:#000>n</span><span style=color:#000>;(</span><span style=color:#000>n</span> <span style=color:#000>=</span> <span style=color:#000>rd</span><span style=color:#000>.</span><span style=color:#836c28>read</span><span style=color:#000>(</span><span style=color:#000>chBuffer</span><span style=color:#000>))</span> <span style=color:#000>!=</span> <span style=color:#000>-</span><span style=color:#000>1</span><span style=color:#000>;)</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>            <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>n</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>            <span style=color:#177500>// 字符数组offset, len)
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#177500></span>            <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>String</span><span style=color:#000>(</span><span style=color:#000>chBuffer</span><span style=color:#000>,</span> <span style=color:#000>0</span><span style=color:#000>,</span> <span style=color:#000>n</span><span style=color:#000>));</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>        <span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    <span style=color:#000>}</span> <span style=color:#a90d91>catch</span> <span style=color:#000>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#000>)</span> <span style=color:#000>{}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>    <span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#177500>// 其他实现类
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#177500>// CharArrayReader，内存中模拟Reader流，实际上是一个char[]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>Reader</span> <span style=color:#000>reader</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>CharArrayReader</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>.</span><span style=color:#836c28>toCharArray</span><span style=color:#000>()))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#177500>// StringReader， 可以直接把String当作输入流，和CharArrayReader几乎一样
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>Reader</span> <span style=color:#000>reader</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>StringReader</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#177500>// InputStream和Reader：Reader内部有一个InputStream，它先把数据以byte读入InputStream，再以特定的编码转换为char；可以手动转换，利用InputStreamReader
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#177500></span><span style=color:#000>InputStream</span> <span style=color:#000>input</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;src/readme.txt&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#000>Reader</span> <span style=color:#000>reader</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>InputStreamReader</span><span style=color:#000>(</span><span style=color:#000>input</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;UTF-8&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span style=color:#177500>// 简化代码，构造Reader时传入InputStream，这实际上时FileReader的一种实现方式
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span style=color:#177500></span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>Reader</span> <span style=color:#000>reader</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>InputStreamReader</span><span style=color:#000>(</span><span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;src/readme.txt&#34;</span><span style=color:#000>),</span> <span style=color:#c41a16>&#34;UTF-8&#34;</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>    <span style=color:#177500>// TODO:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#177500></span><span style=color:#000>}</span>
</code></pre></div><h3 id=printstreamprintwriter>PrintStream/PrintWriter</h3><p><strong>PrintStream</strong></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#000>PrintStream</span><span style=color:#000>`</span><span style=color:#000>是一种</span><span style=color:#000>`</span><span style=color:#000>FilterOutputStream</span><span style=color:#000>`，</span><span style=color:#000>总是以byte数据输出</span><span style=color:#000>；</span><span style=color:#000>额外提供了一些写入各种数据</span><span style=color:#000>(</span><span style=color:#a90d91>int</span><span style=color:#000>,</span> <span style=color:#a90d91>boolean</span><span style=color:#000>,</span> <span style=color:#000>String</span><span style=color:#000>,</span> <span style=color:#000>Object</span><span style=color:#000>…</span><span style=color:#000>)</span><span style=color:#000>的方法</span><span style=color:#000>`</span><span style=color:#000>print</span><span style=color:#000>()/</span><span style=color:#000>println</span><span style=color:#000>()</span><span style=color:#000>`，</span><span style=color:#000>除了提供了额外的方法外还有个特点就是不会抛出</span><span style=color:#000>`</span><span style=color:#000>IOException</span>
</code></pre></div><blockquote><p><code>System.out.print</code>是系统默认提供的<code>PrintStream</code>， 表示标准输出</p><p><code>System.err</code>是系统默认提供的标准错误输出</p></blockquote><p><strong>PrintWriter</strong></p><p><code>PrintWriter</code>扩展了<code>Writer</code>接口，输出的是char数据，使用方法与<code>PrintStream</code>几乎一样</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#000>StringWriter</span> <span style=color:#000>buffer</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>StringWriter</span><span style=color:#000>();</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#a90d91>try</span> <span style=color:#000>(</span><span style=color:#000>PrintWriter</span> <span style=color:#000>pw</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>PrintWriter</span><span style=color:#000>(</span><span style=color:#000>buffer</span><span style=color:#000>))</span> <span style=color:#000>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>    <span style=color:#000>pw</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Hello&#34;</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>    <span style=color:#000>pw</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>12345</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>    <span style=color:#000>pw</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#a90d91>true</span><span style=color:#000>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#000>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span style=color:#000>System</span><span style=color:#000>.</span><span style=color:#836c28>out</span><span style=color:#000>.</span><span style=color:#836c28>println</span><span style=color:#000>(</span><span style=color:#000>buffer</span><span style=color:#000>.</span><span style=color:#836c28>toString</span><span style=color:#000>());</span>
</code></pre></div><p><a href=https://www.liaoxuefeng.com/>参考自廖雪峰的教程</a></p></div><div class=post-tags><nav class="nav tags"><ul class=flat><li><a href=/tags/java>java</a></li></ul></nav></div></div><div class="footer wrapper"><nav class=nav><div><a href=https://github.com/vividvilla/ezhil>Ezhil theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/katex.min.css integrity=sha384-r/BYDnh2ViiCwqZt5VJVWuADDic3NnnTIEOv4hOh05nSfB6tjWpKmn1kUHOVkMXc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/katex.min.js integrity=sha384-zDIgORxjImEWftZXZpWLs2l57fMX9B3yWFPN5Ecabe211Hm5ZG/OIz2b07DYPUcH crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.9/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></body></html>